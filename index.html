<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voucher Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f9;
        }
        .container {
            max-width: 1000px;
            margin: 20px auto;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #555;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 16px;
        }
        select {
            appearance: none;
            background-color: #f9f9f9;
        }
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 10px;
        }
        .btn:hover {
            background-color: #45a049;
        }
        .checklist {
            margin: 10px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #ccc;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
        .upload {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Voucher Entry Form</h1>
        <form id="voucherForm" onsubmit="addFormDataToTable(event)">
            <div class="form-group">
                <label for="voucherNumber">भौचर नं</label>
                <input type="text" id="voucherNumber" name="voucherNumber" placeholder="Enter Voucher Number">
            </div>

            <div class="form-group">
                <label for="source">श्रोत</label>
                <input type="text" id="source" name="source" placeholder="Enter Source">
            </div>

            <div class="form-group">
                <label for="amount">कारोबार रकम</label>
                <input type="number" id="amount" name="amount" placeholder="Enter Amount">
            </div>

            <div class="form-group">
                <label for="transactionDetails">कारोबारको ब्यहोरा</label>
                <textarea id="transactionDetails" name="transactionDetails" placeholder="Enter Transaction Details"></textarea>
            </div>

            <div class="form-group">
                <label for="payeeName">भुक्तानी पाउनेको नाम</label>
                <input type="text" id="payeeName" name="payeeName" placeholder="Enter Payee Name">
            </div>

            <div class="form-group">
                <label for="panNumber">पान नं</label>
                <input type="text" id="panNumber" name="panNumber" placeholder="Enter PAN Number">
            </div>

            <div class="form-group">
                <label for="expenseType">खर्च शिर्षक</label>
                <select id="expenseType" name="expenseType" onchange="updateExpenseChecklist()">
                    <option value="">-- Select Type --</option>
                    <option value="current">चालु</option>
                    <option value="capital">पुजिगत</option>
                </select>
            </div>

            <div class="form-group">
                <label for="branch">शाखाहरुको नाम</label>
                <input type="text" id="branch" name="branch" placeholder="Enter Branch Name">
            </div>

            <div class="form-group">
                <label for="remarks">कैफीयत</label>
                <textarea id="remarks" name="remarks" placeholder="Enter Remarks"></textarea>
            </div>

            <table id="dataTable">
                <thead>
                    <tr>
                        <th>भौचर नं</th>
                        <th>श्रोत</th>
                        <th>कारोबार रकम</th>
                        <th>कारोबारको ब्यहोरा</th>
                        <th>भुक्तानी पाउनेको नाम</th>
                        <th>पान नं</th>
                        <th>खर्च शिर्षक</th>
                        <th>शाखाहरुको नाम</th>
                        <th>कैफीयत</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>

            <h2>बिल र भरपाइ तालिका</h2>
            <table id="calculationTable">
                <thead>
                    <tr>
                        <th>क्रस</th>
                        <th>PAN बिल</th>
                        <th>VAT बिल</th>
                        <th>भरपाइ</th>
                        <th>कर नलाग्ने बिल तथा भरपाइ</th>
                        <th>डोर हाजीरी</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="number" class="calc-input" oninput="calculateTotals()"></td>
                        <td><input type="number" class="calc-input" oninput="calculateTotals()"></td>
                        <td><input type="number" class="calc-input" oninput="calculateTotals()"></td>
                        <td><input type="number" class="calc-input" oninput="calculateTotals()"></td>
                        <td><input type="number" class="calc-input" oninput="calculateTotals()"></td>
                        <td><input type="number" class="calc-input" oninput="calculateTotals()"></td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="6" style="text-align:right; font-weight:bold;">योगफल:</td>
                        <td id="totalCell" style="font-weight:bold;">0</td>
                    </tr>
                </tfoot>
            </table>

            <button type="button" class="btn" onclick="addRowToCalculationTable()">Add Row</button>
            <button type="submit" class="btn">Submit</button>
            <button type="button" class="btn" onclick="downloadTableAsWord()">Download as Word</button>
        </form>
    </div>

    <script>
        function updateExpenseChecklist() {
            const expenseType = document.getElementById('expenseType').value;
            document.getElementById('currentExpenses').style.display = expenseType === 'current' ? 'block' : 'none';
            document.getElementById('capitalExpenses').style.display = expenseType === 'capital' ? 'block' : 'none';
        }

        function addFormDataToTable(event) {
            event.preventDefault();
            const table = document.getElementById('dataTable').getElementsByTagName('tbody')[0];
            const row = table.insertRow();

            const formData = [
                document.getElementById('voucherNumber').value,
                document.getElementById('source').value,
                document.getElementById('amount').value,
                document.getElementById('transactionDetails').value,
                document.getElementById('payeeName').value,
                document.getElementById('panNumber').value,
                document.getElementById('expenseType').value,
                document.getElementById('branch').value,
                document.getElementById('remarks').value
            ];

            formData.forEach(data => {
                const cell = row.insertCell();
                cell.textContent = data;
            });

            document.getElementById('voucherForm').reset();
        }

        function addRowToCalculationTable() {
            const table = document.getElementById('calculationTable').getElementsByTagName('tbody')[0];
            const row = table.insertRow();
            for (let i = 0; i < 6; i++) {
                const cell = row.insertCell();
                cell.innerHTML = '<input type="number" class="calc-input" oninput="calculateTotals()">';
            }
        }

        function calculateTotals() {
            const inputs = document.querySelectorAll('.calc-input');
            let total = 0;
            inputs.forEach(input => {
                total += parseFloat(input.value) || 0;
            });
            document.getElementById('totalCell').textContent = total.toFixed(2);
        }

        function downloadTableAsWord() {
            const table = document.getElementById('dataTable');
            let html = "<table border='1' style='border-collapse: collapse; width: 100%;'>";
            html += table.innerHTML;
            html += "</table>";

            const blob = new Blob(['\ufeff' + html], { type: 'application/msword' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'voucher_data.doc';
            link.click();
        }
    </script>
</body>
</html>
